<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Demo - gtfs-sqljs</title>
  <link rel="icon" type="image/png" sizes="32x32" href="./logo-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./logo-16.png">
  <link rel="icon" type="image/svg+xml" href="./logo.svg">
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <div class="logo">
        <img src="./logo.svg" alt="gtfs-sqljs logo" width="40" height="40" style="vertical-align: middle; margin-right: 10px;">
        <span>gtfs-sqljs</span>
      </div>
      <ul class="nav-links">
        <li><a href="./index.html">Documentation</a></li>
        <li><a href="./demo.html" class="active">Demo</a></li>
        <li><a href="https://github.com/sysdevrun/gtfs-sqljs" target="_blank">GitHub</a></li>
      </ul>
    </div>
  </nav>

  <main class="container">
    <section class="demo-header">
      <h1>Interactive Demo</h1>
      <div class="url-input-section">
        <label for="gtfs-url-input">GTFS ZIP URL (https only):</label>
        <input
          type="url"
          id="gtfs-url-input"
          placeholder="https://pysae.com/api/v2/groups/car-jaune/gtfs/pub"
          value="https://pysae.com/api/v2/groups/car-jaune/gtfs/pub"
        />
        <button id="load-gtfs-btn" class="button button-primary">Load GTFS</button>
      </div>
      <div class="url-input-section">
        <label for="gtfs-rt-url-input">GTFS-RT URL (https only, optional):</label>
        <input
          type="url"
          id="gtfs-rt-url-input"
          placeholder="https://pysae.com/api/v2/groups/car-jaune/gtfs-rt"
          value="https://pysae.com/api/v2/groups/car-jaune/gtfs-rt"
        />
        <button id="fetch-rt-btn" class="button button-secondary" disabled>Fetch RT Data</button>
        <button id="auto-refresh-btn" class="button button-secondary" disabled>Fetch RT Data Every 10s</button>
      </div>
    </section>

    <div id="loading" class="loading">
      <div class="spinner"></div>
      <p>Loading GTFS data...</p>
    </div>

    <div id="error" class="error" style="display: none;">
      <p id="error-message">Error loading GTFS data. Please refresh the page.</p>
    </div>

    <div id="demo-content" style="display: none;">
      <section class="demo-section" id="agencies-section">
        <h2>Transit Agencies</h2>
        <div id="agencies-list" class="agencies-list">
          <p>Loading agencies...</p>
        </div>
      </section>

      <section class="demo-section download-section">
        <button id="download-db-btn" class="button button-primary">
          ðŸ“¥ Download SQLite Database
        </button>
        <p class="help-text">Download the processed GTFS data as a SQLite database file</p>
      </section>

      <section class="demo-section date-section">
        <h2>Select Date</h2>
        <div class="date-selector">
          <input type="date" id="date-input" />
        </div>
        <div id="active-calendars" class="active-calendars">
          <p>Loading...</p>
        </div>
      </section>

      <section class="demo-section">
        <h2>Routes</h2>
        <p class="help-text">Click on a route to see its trips for the selected date</p>
        <div id="routes-list" class="routes-list">
          <p>Loading routes...</p>
        </div>
      </section>

      <section class="demo-section" id="trips-section" style="display: none;">
        <h2>Trips for <span id="selected-route-name"></span></h2>
        <p class="help-text">Click on a trip to see stop times</p>
        <div id="trips-list" class="trips-list">
          <p>Loading trips...</p>
        </div>
      </section>

      <section class="demo-section" id="stop-times-section" style="display: none;">
        <h2>Stop Times for <span id="selected-trip-name"></span></h2>
        <div id="stop-times-list" class="stop-times-list">
          <p>Loading stop times...</p>
        </div>
      </section>

      <section class="demo-section" id="alerts-section">
        <h2>Active Alerts</h2>
        <div id="alerts-list" class="alerts-list">
          <p class="no-data">No realtime data loaded. Use the "Fetch RT Data" button above.</p>
        </div>
      </section>

      <section class="demo-section" id="vehicles-section">
        <h2>Tracked Vehicles</h2>
        <div id="vehicles-count" class="vehicles-count">
          <p class="no-data">No realtime data loaded. Use the "Fetch RT Data" button above.</p>
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2024 ThÃ©ophile Helleboid / SysDevRun. Licensed under MIT.</p>
    </div>
  </footer>

  <script type="module" src="/demo.ts"></script>
</body>
</html>
